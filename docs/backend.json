{
  "entities": {
    "Grievance": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Grievance",
      "type": "object",
      "description": "Represents a grievance submitted by a user.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the grievance."
        },
        "userId": {
          "type": "string",
          "description": "Reference to the User who submitted the grievance. (Relationship: User 1:N Grievance)"
        },
        "description": {
          "type": "string",
          "description": "Detailed description of the grievance."
        },
        "imageUrl": {
          "type": "string",
          "description": "URL of the image associated with the grievance.",
          "format": "uri"
        },
        "latitude": {
          "type": "number",
          "description": "Latitude of the grievance location."
        },
        "longitude": {
          "type": "number",
          "description": "Longitude of the grievance location."
        },
        "submissionDate": {
          "type": "string",
          "description": "Date and time when the grievance was submitted.",
          "format": "date-time"
        },
        "status": {
          "type": "string",
          "description": "Current status of the grievance (e.g., submitted, in progress, resolved).",
          "format": "string"
        }
      },
      "required": [
        "id",
        "userId",
        "description",
        "imageUrl",
        "latitude",
        "longitude",
        "submissionDate",
        "status"
      ]
    },
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user."
        },
        "email": {
          "type": "string",
          "description": "Email address of the user.",
          "format": "email"
        },
        "name": {
          "type": "string",
          "description": "Full name of the user."
        },
        "registrationDate": {
          "type": "string",
          "description": "Date and time when the user registered.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "email",
        "name",
        "registrationDate"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profiles. Uses path-based ownership for user data.",
          "params": [
            {
              "name": "userId",
              "description": "Unique identifier for the user."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/grievances/{grievanceId}",
        "definition": {
          "entityName": "Grievance",
          "schema": {
            "$ref": "#/backend/entities/Grievance"
          },
          "description": "Stores grievance data. Each grievance is stored as a subcollection of the corresponding user document. Includes denormalized 'userId' for authorization independence.",
          "params": [
            {
              "name": "userId",
              "description": "Unique identifier for the user who submitted the grievance."
            },
            {
              "name": "grievanceId",
              "description": "Unique identifier for the grievance."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to provide a secure, scalable, and easily maintainable backend for the ResolveX application, focusing on user authentication, grievance submission, and live tracking. It leverages path-based ownership for user-specific data and incorporates denormalization to ensure authorization independence. This approach avoids using `get()` calls in security rules, which are inefficient and can lead to security vulnerabilities. The structure includes dedicated collections for users and their grievances. The design prioritizes Authorization Independence, Clarity of Intent, DBAC, and QAPs.\n\n1.  **Users Collection:** Stores user profiles. Path-based ownership is used for user data (`/users/{userId}`).\n2.  **Grievances Collection:** Stores grievance data. Each grievance is stored as a subcollection of the corresponding user document (`/users/{userId}/grievances/{grievanceId}`). This establishes clear ownership and simplifies security rules. To ensure Authorization Independence, the userId is included in each grievance document.\n\nThis structure effectively achieves Authorization Independence as security rules for accessing grievances can directly rely on the `request.auth.uid` and the `userId` field in the grievance document without needing to perform costly and potentially insecure `get()` calls. The separation of user and grievance data into distinct collections also supports required QAPs, allowing secure `list` operations for user-specific grievances. The structure is designed to be Radically Consistent with semantic naming conventions."
  }
}